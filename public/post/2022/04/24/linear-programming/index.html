<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Linear Programming - Runqiu&#39;s Personal Blog</title>
    <meta property="og:title" content="Linear Programming - Runqiu&#39;s Personal Blog">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="每一个Constraint是一个Equation，表示为\(\mathbf{a^TX=\beta}\)，表示一个平面
[&amp;hellip;] 因此，想要\(\min \mathbf{c^TX}\)，应当向着\(-\mathbf{c}\)的方向改变X。
如果可行域\(P\)完全落在某一个平面\(\mathbf{-c^Tx}=\beta\)对应的平面的下半平面，那么\(\mathbf{c^Tx}\) &amp;hellip;">
      <meta property="og:description" content="每一个Constraint是一个Equation，表示为\(\mathbf{a^TX=\beta}\)，表示一个平面
[&amp;hellip;] 因此，想要\(\min \mathbf{c^TX}\)，应当向着\(-\mathbf{c}\)的方向改变X。
如果可行域\(P\)完全落在某一个平面\(\mathbf{-c^Tx}=\beta\)对应的平面的下半平面，那么\(\mathbf{c^Tx}\) &amp;hellip;">
      
    

    
    
    <meta name="twitter:image" content="https://runqhu.com/post/2022/04/24/linear-programming/index_files/figure-html/unnamed-chunk-2-1.png">
    
    

    

    
    

    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="post">
    <header class="masthead">
      <h1><a href="/">Runqiu&#39;s Personal Blog</a></h1>

<p class="tagline">Powered By Blogdown X Hugo-ivy</p>

      <nav class="menu">
  <input id="menu-check" type="checkbox" hidden/>
  <label id="menu-label" for="menu-check" class="unselectable" hidden>
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/">Home</a></li>
  
  <li><a href="/about/">About</a></li>
  
  <li><a href="/categories/">Categories</a></li>
  
  <li><a href="/tags/">Tags</a></li>
  
  <li><a href="/index.xml">Subscribe</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Linear Programming</h1>

<h3>HU Runqiu
  /  2022-04-24</h3>
<hr>


      </header>








<div id="constraint的几何意义" class="section level1">
<h1>Constraint的几何意义</h1>
<p>每一个Constraint是一个Equation，表示为<span class="math inline">\(\mathbf{a^TX=\beta}\)</span>，表示一个平面</p>
<ul>
<li><span class="math inline">\(\mathbf{a^TX&gt;\beta}\)</span> 表示该平面上半空间（Half Space）</li>
<li><span class="math inline">\(\mathbf{a^TX&gt;\beta}\)</span> 表示该平面下半空间（Lower Space）</li>
<li><span class="math inline">\(\mathbf{a}\)</span> 表示法向量，与该平面垂直，指向使得<span class="math inline">\(\mathbf{a^TX}\)</span>增大的方向（<span class="math inline">\(\mathbf{a^TX&gt;\beta}\)</span>的方向，即上半空间）</li>
</ul>
<p>因此，想要<span class="math inline">\(\min \mathbf{c^TX}\)</span>，应当向着<span class="math inline">\(-\mathbf{c}\)</span>的方向改变X。</p>
<p>如果可行域<span class="math inline">\(P\)</span>完全落在某一个平面<span class="math inline">\(\mathbf{-c^Tx}=\beta\)</span>对应的平面的下半平面，那么<span class="math inline">\(\mathbf{c^Tx}\)</span>在<span class="math inline">\(P\)</span>内的最小值有一个下界<span class="math inline">\(-\beta\)</span>。</p>
<p>沿着<span class="math inline">\(-c\)</span>（法向量）的方向走，目标函数<span class="math inline">\(\mathbf{-c^Tx}\)</span>的值越来越大，对应地，沿着<span class="math inline">\(c\)</span>（法向量）的方向走，<span class="math inline">\(\mathbf{-c^Tx}\)</span>的值越来越小，<span class="math inline">\(\mathbf{c^Tx}\)</span>的值越来越大，因此<span class="math inline">\(\mathbf{c^Tx}\)</span>的最小值最小只可能是<span class="math inline">\(-\beta\)</span>（正好位于平面<span class="math inline">\(\mathbf{c^Tx=-\beta}\)</span>）。因此，如果可行域与平面相交，那么最值在交点（或线或平面）处取得。</p>
<p>这也解释了为什么Graphical Method，要求先画出可行区域，之后沿着一个方向（目标函数法向量）移动目标函数的曲线，直到找到与可行域的最后一个交点。</p>
<p><img src="https://runqhu.com/post/2022/04/24/linear-programming/index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<blockquote>
<p>Graphical Method：遍历每一个可行域Polyhedral的交点，根据目标函数得到<span class="math inline">\(-c\)</span>的方向，画出对应垂直的平面<span class="math inline">\(\mathbf{-c^Tx=\beta}\)</span>，看可行域是否完全位于该平面的下半空间，若找到则最优解也找到，否则继续遍历。</p>
</blockquote>
<blockquote>
<p>方法存在的问题：交点太多，遍历交点的复杂度指数级</p>
</blockquote>
</div>
<div id="simplex-method" class="section level1">
<h1>Simplex Method</h1>
<p>有效生成和管理可行域交点的方式，避免去每个交点处插旗子（选择性遍历）。</p>
<div id="lp的fundamental-theorem" class="section level2">
<h2>LP的Fundamental Theorem</h2>
<p>有<span class="math inline">\(p\)</span>个点<span class="math inline">\(\mathbf{x^1,x^2,\ldots,x^p}\)</span>，令 <span class="math inline">\(\mathbf{x}=\sum_{i=1}^p\lambda_i\mathbf{x^i}\)</span>，即<span class="math inline">\(p\)</span>个点的线性组合。</p>
<p>二维情景：<span class="math inline">\(\mathbf{x^1}=(0,1)^T, \mathbf{x^2}=(1,0)^T\)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="https://runqiuhu-1301738355.cos.ap-nanjing.myqcloud.com/202204250917333.png" alt="线性组合示意图" width="80%" />
<p class="caption">
Figure 1: 线性组合示意图
</p>
</div>
<p>同样的<span class="math inline">\(\lambda_1+\lambda_2=1\)</span>，得到的线性组合（新的点）为<span class="math inline">\((\lambda_1x^1_1+\lambda_2x^2_1, \lambda_1x^1_2+\lambda_2x^2_2)\)</span>，即<span class="math inline">\((\lambda_1x^1_1+(1-\lambda_1)x^2_1, \lambda_1x^1_2+(1-\lambda_1)x^2_2)=((x_1^1-x_1^2)\lambda_1+x_1^2, (x_2^1-x_2^2)\lambda_1+x_2^2) \rightarrow y=(x-x^2_1)/(x_1^1-x_1^2) * (x_2^1-x_2^2)+x^2_2\)</span>，这就是AB形成的直线。因此，</p>
<ul>
<li>当<span class="math inline">\(\lambda_i \ge 0\)</span>时，它的空间位于为AB线段：convex combination</li>
<li>当不要求<span class="math inline">\(\lambda_i \ge 0\)</span>时，它的空间位于AB所在直线：affine combination</li>
<li>当不要求<span class="math inline">\(\lambda_1+\lambda_2=1\)</span>时，它是整个第一象限：conic combination</li>
</ul>
<p>直观理解：</p>
<ul>
<li>convex组合，两点连线段</li>
<li>affine组合，两点连成直线</li>
<li>conic组合，两点到原点连线向外张成的锥（无限向外不封闭）</li>
</ul>
<p>回到Linear Programming，可行域</p>
<p><span class="math display">\[P=\{\mathbf{x\in R^n} \mid \mathbf{Ax=b, x\ge 0}\}\]</span>
- 是一个Polyhedral Set（<span class="math inline">\(\mathbf{Ax=b}\)</span>对应<span class="math inline">\(2m\)</span>个Half Space交成的<span class="math inline">\(m\)</span>个平面，<span class="math inline">\(n\)</span>为<span class="math inline">\(x_i \ge 0\)</span>对应的<span class="math inline">\(n\)</span>个Half Space</p>
<ul>
<li><p><span class="math inline">\(P\)</span>是convex set</p></li>
<li><p><span class="math inline">\(P\)</span>可看作<span class="math inline">\(m\)</span>个平面 <span class="math inline">\(\cap\)</span> 第一象限，为空则无可行解</p></li>
<li><p>对偶视角：重新看<span class="math inline">\(\mathbf{Ax=b}\)</span></p></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\mathbf{Ax}&amp;=\\
&amp;=\left[ \begin{matrix}
    a_{11}&amp;     a_{12}&amp;     \cdots&amp;     a_{1n}\\
    a_{21}&amp;     a_{22}&amp;     \cdots&amp;     a_{2n}\\
    \vdots&amp;     \vdots&amp;     \ddots&amp;     \vdots\\
    a_{m1}&amp;     a_{m2}&amp;     \cdots&amp;     a_{mn}\\
\end{matrix} \right] \left[ \begin{array}{l}
    x_1\\
    x_2\\
    \vdots\\
    x_n\\
\end{array} \right]\\
&amp;=\left[ \begin{array}{l}
    a_{11}\\
    a_{21}\\
    \vdots\\
    a_{m1}\\
\end{array} \right]x_1+\left[ \begin{array}{l}
    a_{12}\\
    a_{22}\\
    \vdots\\
    a_{m2}\\
\end{array} \right]x_2+\ldots+\left[ \begin{array}{l}
    a_{1n}\\
    a_{2n}\\
    \vdots\\
    a_{mn}\\
\end{array} \right]x_n
\end{aligned}
\]</span></p>
<p>此时，由于<span class="math inline">\(x_i\ge 0\)</span>，可以看做是<span class="math inline">\(n\)</span>个<span class="math inline">\(m\)</span>维向量<span class="math inline">\(A_i\)</span>在<span class="math inline">\(x_i\)</span>作用下张成的锥空间，判断如果<span class="math inline">\(b\)</span>落在这个锥内，那么问题有解。</p>
</div>
<div id="如何得到extreme-point" class="section level2">
<h2>如何得到Extreme Point</h2>
<p>将原问题化为标准形式（添加slack variable等）后，得到<span class="math inline">\(\mathbf{Ax=b}\)</span>，假设得到的方程组有<span class="math inline">\(n\)</span>个变元，<span class="math inline">\(m\)</span>个等式，通常变元多于等式 (<span class="math inline">\(n&gt;m\)</span>)，那么将<span class="math inline">\(n-m\)</span>个变元设为0，剩余<span class="math inline">\(m\)</span>未知数有<span class="math inline">\(m\)</span>个方程，可以求出一个唯一解。这<span class="math inline">\(m\)</span>个非0和<span class="math inline">\(n-m\)</span>个0组成的一个解，就是一个extreme point。</p>
<p>注意：<span class="math inline">\(m\)</span>未知数及<span class="math inline">\(m\)</span>个方程能得到解的前提是，这个<span class="math inline">\(m*m\)</span>的方阵是可逆的，即列之间是线性无关的。（反例：2x+y=1, 4x+2y=1，<span class="math inline">\((2,4)=2(1,2)\)</span>)</p>
<p>因此，选择为非0的变元对应的矩阵，最好是列线性无关的。</p>
<p>定理：<span class="math inline">\(\mathbf{x}=(x_1,x_2,\ldots,x_i)\)</span>是extreme point的充要条件：</p>
<p><span class="math inline">\(x_i&gt;0\)</span>所对应的系数矩阵列之间线性无关。</p>
<p><span class="math inline">\(\mathbf{Ax=b}\)</span>，将其分解开：<span class="math inline">\(\mathbf{B}_{m\times m}\underbrace{\mathbf{x_B}}_{basic\ variables} + \mathbf{N}_{(n-m)\times (n-m)}\underbrace{\mathbf{x_N}}_{non-basic\ variables}\)</span>，得到<span class="math inline">\(\mathbf{B}_{m\times m}\mathbf{x}_B=\mathbf{b}\)</span>，则<span class="math inline">\(\mathbf{x}_B=\mathbf{B^{-1}b}\)</span>，这叫做basic solution</p>
<p>如果还能保证<span class="math inline">\(\mathbf{x}_B=\mathbf{B^{-1}b} \ge 0\)</span>，则为basic feasible solution</p>
<p>显然，从<span class="math inline">\(n\)</span>个变元选<span class="math inline">\(n-m\)</span>个变元设为0，有<span class="math inline">\(C(n,n-m)=C(n,m)\)</span>个选法，即有<span class="math inline">\(C(n,m)\)</span>个basic solution，而basic feasible solution只可能比这个少，具体是否feasible需要逐个验证。</p>
<p>LP的可行域一定是convex的。当可行域是有界时，可行域内任意一点都可以通过extreme的convex组合表示出来。</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="https://runqiuhu-1301738355.cos.ap-nanjing.myqcloud.com/202204250918911.jpg" alt="Extreme Point Convex组合表示任意点" width="80%" />
<p class="caption">
Figure 2: Extreme Point Convex组合表示任意点
</p>
</div>
<p>当可行域无界，需要一个方向<span class="math inline">\(\mathbf{d}\)</span>，任意一个可行域内的点，沿着这个方向走任意远，还在这个可行域内，将这个方向称作extremal direction</p>
<ul>
<li>如果有这个extremal direction <span class="math inline">\(\Leftrightarrow\)</span> <span class="math inline">\(P\)</span>无界（有界的话肯定会冲出去）</li>
<li><span class="math inline">\(\mathbf{Ax=b}\)</span>，<span class="math inline">\(\mathbf{x}\)</span>沿着<span class="math inline">\(\lambda\mathbf{d}\)</span>走任意远到达的点为<span class="math inline">\(\mathbf{x}+\lambda\mathbf{d}\)</span>，要这个点还在<span class="math inline">\(P\)</span>内，那么有<span class="math inline">\(\mathbf{A}(\mathbf{x}+\lambda\mathbf{d})=\mathbf{b}\)</span>，则<span class="math inline">\(\mathbf{Ax}+\lambda\mathbf{Ad}=\mathbf{b}\)</span>，则<span class="math inline">\(\lambda\mathbf{Ad}=0\)</span>，只能是<span class="math inline">\(\mathbf{Ad=0}\)</span>，并且为了保证non-neg，即<span class="math inline">\(\mathbf{x}+\lambda\mathbf{d}\ge 0\)</span>，<span class="math inline">\(\mathbf{d}\)</span>必须&gt;0（否则<span class="math inline">\(\lambda\)</span>走远，无论x如何，都会负）</li>
</ul>
<p>综合结论，得到Resolution Theorem:</p>
<p><span class="math inline">\(V\)</span>是extreme point的合集，<span class="math inline">\(v_i \in V, i \in I\)</span>，<span class="math inline">\(I\)</span>是有限下标集合（不超过<span class="math inline">\(C(n,m)\)</span>），那么<span class="math inline">\(P\)</span>中任何一点可以表示为</p>
<p><span class="math display">\[\mathbf{x}=\sum_{i\in I} \lambda_i v_i +s\mathbf{d}\]</span>
前半部分是convex的线性组合（找到一个起点），后半部分对于有界的<span class="math inline">\(P\)</span>，<span class="math inline">\(s=0\)</span>；否则<span class="math inline">\(s&gt;0\)</span>就是extremal direction（找到一个方向，从起点出发无限开车）。</p>
<p>注意到目标函数<span class="math inline">\(\mathbf{c^Tx}=\sum\lambda_i\mathbf{c^T}v_i+s\mathbf{c^Td}\)</span>，即目标函数值由extreme point对应的函数值，加上系数在extremal方向上的投影值决定。</p>
<p>对最小化问题，观察<span class="math inline">\(\mathbf{c^Tx}=\sum\lambda_i\mathbf{c^T}v_i+s\mathbf{c^Td}\)</span>：</p>
<ul>
<li><span class="math inline">\(\mathbf{c^Td}&lt;0\)</span>，那么<span class="math inline">\(s\)</span>不断增大，<span class="math inline">\(s\mathbf{c^Td}\)</span>无限小，可至负无穷（unbounded）</li>
<li><span class="math inline">\(\mathbf{c^Td}&gt;0\)</span>，<span class="math inline">\(\mathbf{c^Tx}=\sum\lambda_i\mathbf{c^T}v_i+s\mathbf{c^Td}&gt;\sum\lambda_i\mathbf{c^T}v_i\ge\sum\lambda_i\min_i\mathbf{c^T}v_i=cv_{min}\cdot(\sum\lambda_i)=cv_{min}\)</span>，因此，任意<span class="math inline">\(P\)</span>内的<span class="math inline">\(x\)</span>，得到的目标函数值都比最小<span class="math inline">\(c^T\cdot\)</span>(extreme points)要大，那么最优解在最小<span class="math inline">\(c^T\cdot\)</span>(extreme points)取得。</li>
<li>不存在d，即任意点都可以extreme point的convex组合表示，与上一个情况类似，推导第一步直接取等号。</li>
</ul>
<p>得到的结论：</p>
<ul>
<li>LP的可行域非空，那么至少会有一个Extreme Point。</li>
<li>P非空，并且目标函数值不是unbounded，则LP在至少一个extreme point取得最值</li>
<li>P有有穷多个顶点</li>
<li>顶点从代数上看是BFS</li>
</ul>
<p>代数与图形之间的对应：我们希望一个BFS对应一个vertex，因为vertex有限，那么搜索最优只需要遍历vertex，一定是有穷的。</p>
<p>但是实际并不是一一对应，可能出现一个vertex对应多个BFS。原因：当basic-variable的值里出现0，和non-basic variable里的0难以区分，0的分配会有多种组合。</p>
<p>Ax=b 矩阵表示为</p>
<p><span class="math display">\[
\begin{gathered}
\mathrm{A}=[\mathrm{B} \mid \mathrm{N}] \\
\mathrm{x}=\left[\begin{array}{c}
\mathrm{x}_{\mathrm{B}} \\
\mathrm{x}_{N}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{B}^{-1} \mathrm{b} \\
\mathbf{0}
\end{array}\right]
\end{gathered}
\]</span>
这样<span class="math inline">\(Ax\)</span>相乘只能得到<span class="math inline">\(Bx_B\)</span>，
为了在结果中显示出non-basic的0，A变换为</p>
<p><span class="math display">\[
M=\left[\begin{array}{ll}
B &amp; N \\
0 &amp; I
\end{array}\right]
\]</span>
如此，得到
<span class="math display">\[
\mathbf{Mx}=\left[\begin{array}{c}
\mathbf{x_B} \\
\mathbf{x_N}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{Bx_B+Nx_N=b} \\
\mathbf{0x_B+Ix_N=0}
\end{array}\right]
\]</span>
M称为fundamental matrix，<span class="math inline">\(\mathbf{M^{-1}}[b\ \ 0]^T\)</span>为一个basic solution。</p>
<p><span class="math inline">\(|M|=|B||I|-0=|B| \neq 0\)</span>，所以<span class="math inline">\(M\)</span>可逆。<span class="math inline">\(M^{-1}\)</span>矩阵为</p>
<p><span class="math display">\[
M^{-1}=\left[\begin{array}{ll}
B^{-1} &amp; -B^{-1}N \\
0 &amp; I
\end{array}\right]
\]</span>
代数上如何决定neighbouring？basic variable只有一个不同（选为BV的变量，并非具体的值）每个BFS有n-m个neighbors（从nbv里选一个进入bv，替换已有的bv，注意替换不是随便替换，需要通过计算把等于0的bv替换走，所以是n-m）</p>
</div>
</div>



  <footer>
  
<nav class="post-nav">
  <span class="nav-prev"></span>
  <span class="nav-next"></span>
</nav>





<script src="//yihui.org/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.org/js/center-img.js"></script>

  

  
  <hr>
  <div class="copyright">© <a href="https://runqhu.com">Runqiu Hu</a> 2022 | <a href="https://www.zhihu.com/people/BobHuNanjing">Zhihu</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

